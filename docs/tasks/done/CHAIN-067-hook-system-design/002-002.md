# Task: Implement post_message hook action

**Chain**: CHAIN-067-hook-system-design  
**Task**: 002-002  
**Status**: done  
**Type**: impl  
**Created**: 2025-12-13

---

## Objective

Implement the `post_message` hook action in `TransitionHookRunner`. This action posts messages to workflow sessions (orchestrator, control, or specific session IDs) as defined in ADR-012.

---

## Expected Files

- `packages/core/src/workflow/hook-runner.ts` — Add post_message action handler
- `packages/core/src/workflow/__tests__/hook-runner.test.ts` — Tests for post_message action

---

## Acceptance Criteria

- [x] `post_message` action handler in `TransitionHookRunner.runAction()`
- [x] Supports `target`: `"orchestrator"`, `"control"`, or session ID
- [x] Supports `content` and `metadata` properties
- [x] Uses injected message poster (dependency injection pattern)
- [x] Returns `HookActionResult` with success/failure
- [x] Unit tests for post_message action
- [x] `pnpm --filter @choragen/core test` passes

---

## Notes

**Completed 2025-12-12**: Implemented `messagePoster` injection, `post_message` handler with target/content validation, and `HookActionResultDetails.postMessage` structure. Added 2 unit tests.

---

## Task Type Reference

- **impl** (default): Requires handoff to implementation agent in a fresh session
- **control**: Control agent executes directly (e.g., verification, review, closure tasks)
