# Task: Implement spawn_agent hook action

**Chain**: CHAIN-067-hook-system-design  
**Task**: 004-004  
**Status**: done  
**Type**: impl  
**Created**: 2025-12-13

---

## Objective

Implement the `spawn_agent` hook action in `TransitionHookRunner`. This action spawns agent sessions with specified roles and context, enabling automated agent orchestration.

---

## Expected Files

- `packages/core/src/workflow/hook-runner.ts` — Add spawn_agent action handler
- `packages/core/src/workflow/__tests__/hook-runner.test.ts` — Tests for spawn_agent action

---

## Acceptance Criteria

- [x] `spawn_agent` action handler in `TransitionHookRunner.runAction()`
- [x] Supports `role` (e.g., `"implementation"`, `"review"`, `"design"`)
- [x] Supports `context` object with `taskId`, `chainId`, etc.
- [x] Uses injected agent spawner (dependency injection pattern)
- [x] Returns `HookActionResult` with session ID
- [x] Unit tests for spawn_agent action
- [x] `pnpm --filter @choragen/core test` passes

---

## Notes

**Completed 2025-12-12**: Implemented `agentSpawner` injection, `spawn_agent` handler with role validation, and `HookActionResultDetails.spawnAgent` structure including sessionId extraction. Added 2 unit tests.

---

## Task Type Reference

- **impl** (default): Requires handoff to implementation agent in a fresh session
- **control**: Control agent executes directly (e.g., verification, review, closure tasks)
