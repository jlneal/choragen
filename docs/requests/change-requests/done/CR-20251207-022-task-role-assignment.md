# Change Request: Task-Level Role Assignment

**ID**: CR-20251207-022  
**Domain**: core  
**Status**: done  
**Created**: 2025-12-07  
**Owner**: control-agent  

---

## What

Add explicit role assignment to task files via a `**Type**` field that indicates whether a task should be executed by a control agent or implementation agent.

---

## Why

Currently, task files don't declare who should execute them. The `control-agent.md` doc mentions marking control-only tasks with `**Type**: control`, but no tasks in the codebase actually use this field. This ambiguity allows role blurring where control agents implement code or impl agents perform control functions.

Explicit role assignment is foundational for deterministic enforcement—you can't enforce role boundaries if tasks don't declare which role should execute them.

---

## Scope

**In Scope**:
- Add `**Type**: impl | control` field to task template
- Update task template documentation
- Define criteria for when each type applies
- Backfill existing task files in `done/` with appropriate type (optional, for consistency)

**Out of Scope**:
- CLI enforcement of role boundaries (CR-20251207-021)
- Runtime validation (future work)
- Governance schema changes (CR-20251207-020)

---

## Affected Design Documents

- [docs/design/core/features/agent-workflow.md](../../design/core/features/agent-workflow.md)

---

## Linked ADRs

- [ADR-004: Agent Role Separation](../../adr/done/ADR-004-agent-role-separation.md)

---

## Acceptance Criteria

- [x] Task template includes `**Type**: impl | control` field
- [x] `templates/AGENTS.md` documents the Type field and when to use each value
- [x] `docs/agents/control-agent.md` updated to reference Type field usage
- [x] `docs/agents/impl-agent.md` updated to reference Type field usage
- [x] At least one example task demonstrates each type

---

## Commits

No commits yet.

---

## Implementation Notes

Type assignment criteria:
- `impl` — Tasks that create/modify code, tests, or implementation artifacts
- `control` — Tasks that verify, review, close, commit, or manage workflow state

---

## Completion Notes

Implemented task-level role assignment via CHAIN-035-task-role-assignment:

**Changes**:
- `packages/core/src/tasks/types.ts` — Added `TaskType` type and `TASK_TYPES` constant
- `packages/core/src/tasks/task-parser.ts` — Parse/serialize Type field, add Task Type Reference section
- `templates/AGENTS.md` — Documented Type field with usage guidance
- `docs/agents/control-agent.md` — Added Task Type Field section
- `docs/agents/impl-agent.md` — Added Type field check in How to Start, Task Type Field section

**Result**: All new tasks generated by CLI include `**Type**: impl` and the Task Type Reference section. Agent docs clearly explain when to use each type.
