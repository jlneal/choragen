name: standard
displayName: Standard Workflow
description: Execute a committed request through design, implementation, and completion
stages:
  - name: planning
    type: design
    role: orchestration
    gate:
      type: human_approval
      prompt: "Design chains ready. Proceed?"
    onEnter:
      - type: file_move
        from: "docs/requests/change-requests/todo/{{requestId}}.md"
        to: "docs/requests/change-requests/doing/{{requestId}}.md"

  - name: design
    type: implementation
    role: design
    gate:
      type: chain_complete
    onEnter:
      - type: command
        command: "choragen chain:spawn-agents {{chainIds}}"

  - name: impl-planning
    type: design
    role: orchestration
    gate:
      type: human_approval
      prompt: "Implementation chains ready. Proceed?"

  - name: implementation
    type: implementation
    role: implementation
    gate:
      type: chain_complete
    onEnter:
      - type: command
        command: "choragen chain:spawn-agents {{chainIds}}"

  - name: verification
    type: verification
    role: system
    gate:
      type: verification_pass
      commands:
        - "pnpm build"
        - "pnpm test"
        - "pnpm lint"

  - name: commit
    type: implementation
    role: commit
    gate:
      type: human_approval
      prompt: "Commits ready. Push?"

  - name: request-review
    type: review
    role: review
    gate:
      type: human_approval
      prompt: "Request complete. Approve and push?"

  - name: completion
    type: review
    role: control
    gate:
      type: human_approval
      prompt: "Final approval. Close request?"
    onExit:
      - type: file_move
        from: "docs/requests/change-requests/doing/{{requestId}}.md"
        to: "docs/requests/change-requests/done/{{requestId}}.md"
      - type: command
        command: "choragen request:close {{requestId}}"
      - type: command
        command: "choragen chain:archive {{chainIds}}"
